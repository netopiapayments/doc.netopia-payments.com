"use strict";(self.webpackChunkportal=self.webpackChunkportal||[]).push([[5401],{6748:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"payment-sdks/php","title":"PHP SDK","description":"Overview","source":"@site/docs/payment-sdks/php.md","sourceDirName":"payment-sdks","slug":"/payment-sdks/php","permalink":"/docs/payment-sdks/php","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"PHP SDK"},"sidebar":"docsSidebar","previous":{"title":"Payment SDKs","permalink":"/docs/payment-sdks"},"next":{"title":"Node.js SDK","permalink":"/docs/payment-sdks/nodejs"}}');var s=t(4848),i=t(8453);const a={sidebar_position:1,title:"PHP SDK"},o=void 0,l={},c=[{value:"Overview",id:"overview",level:2},{value:"Features",id:"features",level:3},{value:"Installation",id:"installation",level:2},{value:"Install the SDK",id:"install-the-sdk",level:3},{value:"API Specifications",id:"api-specifications",level:3},{value:"API Reference",id:"api-reference",level:2},{value:"Start Payment",id:"start-payment",level:3},{value:"Step 1",id:"step-1",level:4},{value:"Step 2",id:"step-2",level:4},{value:"Step 3",id:"step-3",level:4},{value:"Example response",id:"example-response",level:4},{value:"Status and error codes",id:"status-and-error-codes",level:4},{value:"Authorize (3D Secure cards)",id:"authorize-3d-secure-cards",level:3},{value:"Verify Authentication",id:"verify-authentication",level:3},{value:"Verify Authentication settings:",id:"verify-authentication-settings",level:4},{value:"Create the verify-auth JSON request:",id:"create-the-verify-auth-json-request",level:4},{value:"Send the verify-auth JSON request:",id:"send-the-verify-auth-json-request",level:4},{value:"Example request",id:"example-request",level:4},{value:"Example response",id:"example-response-1",level:4}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"The NETOPIA Payments PHP SDK provides seamless integration with the Netopia Payments API v2. It allows developers to handle payments, IPN verification, and status retrieval efficiently within their PHP applications."}),"\n",(0,s.jsxs)(n.p,{children:["Github Repository: ",(0,s.jsx)(n.a,{href:"https://github.com/netopiapayments/composer",children:"https://github.com/netopiapayments/composer"})]}),"\n",(0,s.jsx)(n.h3,{id:"features",children:"Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Start a payment with customer details, products, and billing/shipping data."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Retrieve the status of an order."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Verify 3D Secure authentications."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Validate IPNs (Instant Payment Notifications) for order updates."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Compatible with both Sandbox and Live environments."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsx)(n.h3,{id:"install-the-sdk",children:"Install the SDK"}),"\n",(0,s.jsxs)(n.p,{children:["To install the library via ",(0,s.jsx)(n.a,{href:"https://getcomposer.org/",children:"composer"}),", run the following command:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"composer require netopia/payment2\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Or add ",(0,s.jsx)(n.code,{children:'"netopia/payment2": "^1.0.0"'}),' to the "require" section in the ',(0,s.jsx)(n.strong,{children:"composer.json"})," file."]}),"\n",(0,s.jsx)(n.h3,{id:"api-specifications",children:"API Specifications"}),"\n",(0,s.jsxs)(n.p,{children:["You can find the API specs here: ",(0,s.jsx)(n.a,{href:"https://secure.sandbox.netopia-payments.com/spec",children:"https://secure.sandbox.netopia-payments.com/spec"})]}),"\n",(0,s.jsx)(n.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,s.jsx)(n.h3,{id:"start-payment",children:"Start Payment"}),"\n",(0,s.jsx)(n.p,{children:"Initiates a payment transaction."}),"\n",(0,s.jsx)(n.h4,{id:"step-1",children:"Step 1"}),"\n",(0,s.jsx)(n.p,{children:"Define settings:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"    $request = new Request();\n    $request->posSignature  = 'XXXX-XXXX-XXXX-XXXX-XXXX';                                 // Your signiture ID here\n    $request->apiKey        = 'ApiKey_GENERATE-YOUR-KEY-FROM-MobilPay-AND-USE-IT-HERE';   // Your API key here\n    $request->isLive        = false;                                                      // false for SANDBOX & true for LIVE\n    $request->notifyUrl     = 'http://your-domain.com/ipn.php';                           // Path of your IPN\n    $request->redirectUrl   = null;\n"})}),"\n",(0,s.jsx)(n.h4,{id:"step-2",children:"Step 2"}),"\n",(0,s.jsx)(n.p,{children:"Make a start JSON request:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"    $request->setRequest($configData, $cardData, $orderData, $threeDSecusreData);\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"You can look at a sample JSON below:"}),"\n"]}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"View JSON"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'    {\n        "config": {\n            "emailTemplate": "",\n            "notifyUrl": "http://your-domain/example/ipn.php",\n            "redirectUrl": "http://your-domain/example/backUrl.php",\n            "language": "RO"\n        },\n        "payment": {\n            "options": {\n                "installments": 1,\n                "bonus": 0\n            },\n            "instrument": {\n                "type": "card",\n                "account": "9900009184214768",\n                "expMonth": 11,\n                "expYear": 2025,\n                "secretCode": "111",\n                "token": null\n            },\n            "data": {\n                "BROWSER_USER_AGENT": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome",\n                "OS": "Linux",\n                "OS_VERSION": "x86_64",\n                "MOBILE": "false",\n                "SCREEN_POINT": "false",\n                "SCREEN_PRINT": "Current Resolution: 1920x1080, Available Resolution: 1920x1080, Color Depth: 24",\n                "BROWSER_COLOR_DEPTH": "24",\n                "BROWSER_SCREEN_HEIGHT": "1080",\n                "BROWSER_SCREEN_WIDTH": "1920",\n                "BROWSER_PLUGINS": "PDF Viewer, Chrome PDF Viewer, Chromium PDF Viewer, Microsoft Edge PDF Viewer",\n                "BROWSER_JAVA_ENABLED": "false",\n                "BROWSER_LANGUAGE": "en-US",\n                "BROWSER_TZ": "Europe/Bucharest",\n                "BROWSER_TZ_OFFSET": "-120",\n                "IP_ADDRESS": "37.221.166.134"\n            }\n        },\n        "order": {\n            "ntpID": "",\n            "posSignature": "1PD2-FYKC-R27B-55BW-NVGN",\n            "dateTime": "2022-11-21T14:13:13+02:00",\n            "description": "DEMO API FROM WEB - SDK",\n            "orderID": "R973i8Stza46n0me152oidgnr_492",\n            "amount": 159.9,\n            "currency": "RON",\n            "billing": {\n                "email": "clientemail84@5n3a4dmoi.com",\n                "phone": "9430715286",\n                "firstName": "Client prenume d21anr3",\n                "lastName": "Client nume nd21ar3",\n                "city": "Bucuresti",\n                "country": 642,\n                "state": "Bucuresti",\n                "postalCode": "246513",\n                "details": "Fara Detalie"\n            },\n            "shipping": {\n                "email": "clientemail84@5n3a4dmoi.com",\n                "phone": "9430715286",\n                "firstName": "Client prenume d21anr3",\n                "lastName": "Client nume nd21ar3",\n                "city": "Bucuresti",\n                "country": 642,\n                "state": "Bucuresti",\n                "postalCode": "246513",\n                "details": "Fara Detalie"\n            },\n            "products": [\n                {\n                    "name": "T-shirt Alfa",\n                    "code": "D276C05398EO14",\n                    "category": "Fashion",\n                    "price": 17,\n                    "vat": 0\n                },\n                {\n                    "name": "T-shirt Beta",\n                    "code": "5E89D3C40O7126",\n                    "category": "Fashion",\n                    "price": 11,\n                    "vat": 0\n                },\n                {\n                    "name": "T-shirt Gamma",\n                    "code": "D9E1826347OC50",\n                    "category": "Fashion",\n                    "price": 91,\n                    "vat": 0\n                },\n                {\n                    "name": "T-shirt Delta",\n                    "code": "3574CE8102DO69",\n                    "category": "Fashion",\n                    "price": 40,\n                    "vat": 0\n                }\n            ],\n            "installments": {\n                "selected": 1,\n                "available": [\n                    0\n                ]\n            },\n            "data": null\n        }\n    }\n'})})]}),"\n",(0,s.jsx)(n.h4,{id:"step-3",children:"Step 3"}),"\n",(0,s.jsx)(n.p,{children:"You can now send your request:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"    $request->startPayment();\n"})}),"\n",(0,s.jsx)(n.h4,{id:"example-response",children:"Example response"}),"\n",(0,s.jsxs)(n.p,{children:["Below you can find an example response. You can also head over to the ",(0,s.jsx)(n.a,{href:"/docs/payment-api/v2.x/introduction",children:"Payment V2 API page"})," for more detailed information."]}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"View response"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'    {\n    "status": 1,\n    "code": 200,\n    "message": "You send your request, successfully",\n    "data": {\n            "customerAction": {\n            "authenticationToken": "0dDmWTelIV7SCTEH65t-rsfTqjZV39ihIBZud-AH_gz_DveTOjocRVUf-AflRAPYtAg5w13q3QgO6RyDIya",\n            "formData": {\n                "backUrl": "http://your-domain/example/backUrl.php",\n                "paReq": "E5bmIpX_RfopDI4uPbvT_ZBsS_hinKMZ8o5nuOPVOZU5F28vOwjDg4LyXzDQeVI="\n            },\n            "type": "Authentication3D",\n            "url": "https://secure.sandbox.netopia-payments.com/sandbox/authorize"\n            },\n            "error": {\n            "code": "100",\n            "message": "Approved"\n            },\n            "payment": {\n            "amount": 143.6,\n            "currency": "RON",\n            "ntpID": "1234567",\n            "status": 15\n            }\n        }\n    }\n'})})]}),"\n",(0,s.jsx)(n.h4,{id:"status-and-error-codes",children:"Status and error codes"}),"\n",(0,s.jsx)(n.p,{children:"To continue the payment progress, you will need to verify the status and error codes you receive in your response."}),"\n",(0,s.jsxs)(n.p,{children:["For example, an error code ",(0,s.jsx)(n.strong,{children:"100"})," and status code ",(0,s.jsx)(n.strong,{children:"15"})," means you need to Authorize the transaction via the cardholder's bank first (3D Secure). An error code ",(0,s.jsx)(n.strong,{children:"0"})," and status code ",(0,s.jsx)(n.strong,{children:"3"})," means that card has no 3D Secure, and that the order is paid."]}),"\n",(0,s.jsxs)(n.p,{children:["For the complete list of codes please go to the ",(0,s.jsx)(n.a,{href:"/docs/payment-api/v2.x/introduction",children:"Payment V2 API page"}),", under the Status & Error codes section."]}),"\n",(0,s.jsx)(n.h3,{id:"authorize-3d-secure-cards",children:"Authorize (3D Secure cards)"}),"\n",(0,s.jsx)(n.p,{children:"This action is used to authorize a 3D Secure card payment."}),"\n",(0,s.jsxs)(n.p,{children:["You will find the parameters that you need to send in the response from ",(0,s.jsx)(n.a,{href:"#startpayment",children:"Start Payment"})," under ",(0,s.jsx)(n.code,{children:"data -> formData"})]}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"View Start Payment response"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'    {\n    "status": 1,\n    "code": 200,\n    "message": "You send your request, successfully",\n--\x3e "data": {\n            "customerAction": {\n            "authenticationToken": "0dDmWTelIV7SCTEH65t-rsfTqjZV39ihIBZud-AH_gz_DveTOjocRVUf-AflRAPYtAg5w13q3QgO6RyDIya",\n--\x3e         "formData": {\n                "backUrl": "http://your-domain/example/backUrl.php",\n                "paReq": "E5bmIpX_RfopDI4uPbvT_ZBsS_hinKMZ8o5nuOPVOZU5F28vOwjDg4LyXzDQeVI="\n            },\n            "type": "Authentication3D",\n            "url": "https://secure.sandbox.netopia-payments.com/sandbox/authorize"\n            },\n            "error": {\n            "code": "100",\n            "message": "Approved"\n            },\n            "payment": {\n            "amount": 143.6,\n            "currency": "RON",\n            "ntpID": "1234567",\n            "status": 15\n            }\n        }\n    }\n'})})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["To complete the Authorize action, please use the detailed information from the ",(0,s.jsx)(n.a,{href:"/docs/payment-api/v2.x/introduction",children:"Payment V2 API"})," Authorize section."]})}),"\n",(0,s.jsx)(n.h3,{id:"verify-authentication",children:"Verify Authentication"}),"\n",(0,s.jsx)(n.p,{children:"Handles 3D Secure verification for transactions."}),"\n",(0,s.jsx)(n.p,{children:"To verify authentication you will need to send the request to verify-auth end point."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Action URL: /payment/card/verify-auth"}),"\n",(0,s.jsx)(n.li,{children:"Method: POST"}),"\n",(0,s.jsx)(n.li,{children:"Param type: JSON"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"verify-authentication-settings",children:"Verify Authentication settings:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"    $verifyAuth = new VerifyAuth();\n    $verifyAuth->apiKey              = 'ApiKey_GENERATE-YOUR-KEY-FROM-MobilPay-AND-USE-IT-HEAR';\n    $verifyAuth->authenticationToken = 'YOUR-UNIQUE-AUTHENTICATION-TOKEN-PER-REQUEST';\n    $verifyAuth->ntpID               = 'THE-UNIQUE-TRANSACTION-ID';\n    $verifyAuth->paRes               = 'THE-DATA-WHAT-YOU-RECIVE-IT-FROM-THE-BANK';\n    $verifyAuth->isLive              = false;       // FALSE for SANDBOX & TRUE for LIVE mode\n"})}),"\n",(0,s.jsx)(n.h4,{id:"create-the-verify-auth-json-request",children:"Create the verify-auth JSON request:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"    $jsonAuthParam = $verifyAuth->setVerifyAuth();\n"})}),"\n",(0,s.jsx)(n.h4,{id:"send-the-verify-auth-json-request",children:"Send the verify-auth JSON request:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:"    $paymentResult = $verifyAuth->sendRequestVerifyAuth($jsonAuthParam);\n"})}),"\n",(0,s.jsx)(n.h4,{id:"example-request",children:"Example request"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'{\n"authenticationToken": "YOUR-UNIQUE-AUTHENTICATION-TOKEN-PER-REQUEST",\n"ntpID": "1234567",\n"formData": \n    {\n        "paRes": "THE-DATA-THAT-YOU-RECEIVE-FROM-THE-BANK"\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"example-response-1",children:"Example response"}),"\n",(0,s.jsxs)(n.p,{children:["Below you can find an example response. You can also head over to the ",(0,s.jsx)(n.a,{href:"/docs/payment-api/v2.x/introduction",children:"Payment V2 API page"})," for more detailed information."]}),"\n",(0,s.jsxs)(t,{children:[(0,s.jsx)("summary",{children:"View response"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'{\n"status": 1,\n"code": 200,\n"message": "Successfully verify authentication ",\n"data": {\n    "error": {\n    "code": "00",\n    "message": "Approved"\n    },\n    "payment": {\n    "amount": 141.7,\n    "currency": "RON",\n    "data": {\n        "AuthCode": "4MHf",\n        "BIN": "990000",\n        "ISSUER": "Netopia GB",\n        "ISSUER_COUNTRY": "642",\n        "RRN": "m5kLj2HOLSfn"\n    },\n    "ntpID": "1234567",\n    "status": 3,\n    "token": "NTY1Mzq4mPwzwb4nynMLEfcwrA0MnEUJ/19Pk9doJWe5PWxoLhQC++W/Eqh6h/wB1KCDVSiBCkaWYtfeWFzWyFoP6YbS"\n    }\n}\n}\n'})})]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var r=t(6540);const s={},i=r.createContext(s);function a(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);